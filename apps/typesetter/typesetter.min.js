$(document).ready(function(){var a,b={settings:{isiOS:!1,fontSelectList:$("#font-families"),textBlock:$('[class^="text-block"]'),dataProperty:$("[data-property]"),addButton:$(".add-text"),removeButton:$(".remove"),closeButton:$(".close"),additionalLink:$(".show-additional"),inputFields:$("input"),loadingMessage:$(".loading-msg"),clickEvent:"createTouch"in document?"touchend":"click"},init:function(){a=this.settings,this.iosDetection(),this.generateFontList(),this.activeEdit(),this.updateProperties(),this.addTextBlock(),this.removeTextBlock(),this.hideSettings(),this.showHideAdditional(),this.incrementValues(),this.disableClick(),this.inputSelect()},disableClick:function(){"touchend"===a.clickEvent&&$("a").on("click",function(b){$(this).trigger(a.clickEvent),b.preventDefault()})},iosDetection:function(){var b=navigator.userAgent.toLowerCase().indexOf("iphone"),c=navigator.userAgent.toLowerCase().indexOf("ipad"),d=navigator.userAgent.toLowerCase().indexOf("ipod");(b>-1||c>-1||d>-1)&&(a.isiOS=!0)},generateFontList:function(){var b=iosFonts;a.isiOS||(b=allFonts),font.setup();for(var c,d=0,e=b.length;e>d;d++)font.isInstalled(b[d])&&(c=$("<option></option>").attr("value",b[d]).text(b[d])),a.fontSelectList.append(c);$('<option value="Verdana">Verdana</option>').insertBefore('option[value="Verdana-Bold"]');var f=a.fontSelectList.find("option").length,g=Math.floor(Math.random()*f);a.fontSelectList.find("option").eq(g).attr("selected","selected"),setTimeout(function(){a.loadingMessage.addClass("remove"),a.textBlock.removeClass("hide"),a.addButton.removeClass("hide")},3e3)},activeEdit:function(){a.textBlock.each(function(){a.textBlock.find("p").on("click",function(){var a=$(this).parent();$('[class^="text-block"]').removeClass("active"),a.addClass("active")})})},updateProperties:function(){a.dataProperty.on("change",function(){$(this).each(function(){var a=$(this),b=a.closest("code").prev(),c=a.data("property");b.css(c,a.val())})}),a.dataProperty.trigger("change")},incrementValues:function(){$("[data-increment]").on(a.clickEvent,function(a){a.preventDefault();var b=$(this),c=b.data("increment"),d=b.prevAll("input").first(),e=d.val(),f=parseFloat(e)+parseFloat(c);0!==f%1&&(f=parseFloat(f).toFixed(2)),d.val(f),d.trigger("change")})},addTextBlock:function(){var b=1,c=textSamples.length,d=0;a.addButton.on("click",function(e){e.preventDefault();var f=$('[class^="text-block"]'),g=f.filter(":last"),h=g.clone(!0).insertBefore(a.addButton).attr("class","text-block-"+b);if(h.find("select").each(function(a){var b=g.find("select");$("option",this)[b[a].selectedIndex].selected=!0}),h.find("[contenteditable='true']").text(textSamples[d]),h.trigger(a.clickEvent).css({display:"block"}),h.find(".show-additional").not(":first").removeClass("open").next(".additional").removeClass("show"),h.find(".show-additional").first().addClass("open").next(".additional").addClass("show"),f.removeClass("active"),h.addClass("active"),1===b){var i=h.find("[data-property='font-size']").val(16);i.trigger("change")}$("body").animate({scrollTop:$(document).height()},{duration:500,complete:function(){$("body").animate({scrollTop:$(window).innerHeight().offset.top-500},{duration:500,complete:function(){}})}}),d>=c-1?d=0:d++,b++})},removeTextBlock:function(){a.removeButton.on("click",function(a){a.preventDefault(),$(this).closest('[class^="text-block"]').hide()})},hideSettings:function(){a.closeButton.on(a.clickEvent,function(a){$('[class^="text-block"]').removeClass("active"),a.preventDefault()})},showHideAdditional:function(){a.additionalLink.on("click",function(a){a.preventDefault(),$(this).each(function(){var a=$(this),b=a.siblings(".show-additional");a.hasClass("open")?a.removeClass("open").next(".additional").removeClass("show"):(b.removeClass("open").next(".additional").removeClass("show"),a.addClass("open").next(".additional").addClass("show"))})})},inputSelect:function(){$("input").on("focus",function(){$(this).get(0).selectionStart=0,$(this).get(0).selectionEnd=999})}};$(function(){b.init()})});